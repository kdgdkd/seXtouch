{
    "device_alias": {
        "CLOCK_IN": "CLOCK",
        "TPT_OUT": "TPT",
        "XTMINI": "X-TOUCH MINI",
        "OUTPUT": "Uno MIDI"
    },
    "version_map": [
        {
            "_comment": "Nota 36",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 36, "value_2_in": 127,
            "version_out": 1
        },
        {
            "_comment": "Nota 49",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 44, "value_2_in": 127,
            "version_out": 1
        },
        {
            "_comment": "Nota 37",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 37, "value_2_in": 127,
            "version_out": 2
        },
        {
            "_comment": "Nota 45",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 45, "value_2_in": 127,
            "version_out": 3
        },
        {
            "_comment": "Nota 40 (XTMINI Botón F5 Layer A) -> Version 4 (Global/Seq Ctrl)",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 40, "value_2_in": 127,
            "version_out": "1 if version == 4 else 4"
        },
        {
            "_comment": "Nota 48 (XTMINI Botón F5 Layer B) -> Version 4 (Global/Seq Ctrl)",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 48, "value_2_in": 127,
            "version_out": "1 if version == 4 else 4"
        },
        {
            "_comment": "Nota 43 (XTMINI Botón F5 Layer A) -> Version 4 (Global/Seq Ctrl)",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 43, "value_2_in": 127,
            "version_out": 0
        },
        {
            "_comment": "Nota 43 (XTMINI Botón F5 Layer A) -> Version 4 (Global/Seq Ctrl)",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_off", "value_1_in": 43, "value_2_in": 127,
            "version_out": 1
        },
        {
            "_comment": "Nota 51 (XTMINI Botón F5 Layer B) -> Version 4 (Global/Seq Ctrl)",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_on", "value_1_in": 48, "value_2_in": 127,
            "version_out": 0
        },
        {
            "_comment": "Nota 51 (XTMINI Botón F5 Layer B) -> Version 4 (Global/Seq Ctrl)",
            "device_in": "XTMINI", "ch_in": 0, "event_in": "note_off", "value_1_in": 48, "value_2_in": 127,
            "version_out": 1
        }
    ],
    "input_filter": [
        {
            "_comment": "Inicialización General y para V0 (Variables, LEDs Transp, Mute, Velo)",
            "version": 0,
            "output": [
                {"var_0": 0}, {"var_1": 0}, {"var_2": 0}, {"var_3": -1},
                {"var_4": 48}, {"var_5": -1}, {"var_6": -1}, 
                {"var_8": "minor_natural"}, 
                {"var_9": 1}, 
                {"var_10": 16},
                {"var_11": 0}, 
                {"var_12": 0}, 
                {"var_15": 1}, 

                {"_comment": "Init/Reset Mute Array"},
                {"set_var": [{"name": "mute", "index":0, "value":0}, {"name": "mute", "index":1, "value":0}, {"name": "mute", "index":2, "value":0}, {"name": "mute", "index":3, "value":0}, {"name": "mute", "index":4, "value":0}, {"name": "mute", "index":5, "value":0}, {"name": "mute", "index":6, "value":0}, {"name": "mute", "index":7, "value":0}, {"name": "mute", "index":8, "value":0}, {"name": "mute", "index":9, "value":0}, {"name": "mute", "index":10, "value":0}, {"name": "mute", "index":11, "value":0}, {"name": "mute", "index":12, "value":0}, {"name": "mute", "index":13, "value":0}, {"name": "mute", "index":14, "value":0}, {"name": "mute", "index":15, "value":0}]},
                {"_comment": "Init/Reset Trans Array"},
                {"set_var": [{"name": "trans", "index":0, "value":0}, {"name": "trans", "index":1, "value":0}, {"name": "trans", "index":2, "value":0}, {"name": "trans", "index":3, "value":0}, {"name": "trans", "index":4, "value":0}, {"name": "trans", "index":5, "value":0}, {"name": "trans", "index":6, "value":0}, {"name": "trans", "index":7, "value":0}, {"name": "trans", "index":8, "value":0}, {"name": "trans", "index":9, "value":0}, {"name": "trans", "index":10, "value":0}, {"name": "trans", "index":11, "value":0}, {"name": "trans", "index":12, "value":0}, {"name": "trans", "index":13, "value":0}, {"name": "trans", "index":14, "value":0}, {"name": "trans", "index":15, "value":0}]},
                {"_comment": "Init Velo Array"},
                {"set_var": [{"name": "velo", "index":0, "value":90}, {"name": "velo", "index":1, "value":90}, {"name": "velo", "index":2, "value":90}, {"name": "velo", "index":3, "value":90}, {"name": "velo", "index":4, "value":90}, {"name": "velo", "index":5, "value":90}, {"name": "velo", "index":6, "value":90}, {"name": "velo", "index":7, "value":90}, {"name": "velo", "index":8, "value":90}, {"name": "velo", "index":9, "value":90}, {"name": "velo", "index":10, "value":90}, {"name": "velo", "index":11, "value":90}, {"name": "velo", "index":12, "value":90}, {"name": "velo", "index":13, "value":90}, {"name": "velo", "index":14, "value":90}, {"name": "velo", "index":15, "value":90}]},
                
                {"_comment": "LEDs Botones Mute (0-15) según array mute"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 0, "value_2_out": "get_var('mute',0)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 1, "value_2_out": "get_var('mute',1)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 2, "value_2_out": "get_var('mute',2)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 3, "value_2_out": "get_var('mute',3)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 4, "value_2_out": "get_var('mute',4)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 5, "value_2_out": "get_var('mute',5)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 6, "value_2_out": "get_var('mute',6)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 7, "value_2_out": "get_var('mute',7)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 8, "value_2_out": "get_var('mute',8)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 9, "value_2_out": "get_var('mute',9)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 10, "value_2_out": "get_var('mute',10)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 11, "value_2_out": "get_var('mute',11)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 12, "value_2_out": "get_var('mute',12)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 13, "value_2_out": "get_var('mute',13)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 14, "value_2_out": "get_var('mute',14)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 15, "value_2_out": "get_var('mute',15)"},

                {"_comment": "LED Ring Behavior (CC 1-8) = Single (0)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 1, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 2, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 3, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 4, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 5, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 6, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 7, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 8, "value_2_out": 0},
                
                {"_comment": "V0: LED Ring Value (CC 9-16) para Encoders 1-8 según array trans"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 9,  "value_2_out": {"scale_value": "get_var('trans', 0)", "range_in": [-12,12], "range_out": [1,13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 10, "value_2_out": {"scale_value": "get_var('trans', 1)", "range_in": [-12,12], "range_out": [1,13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 11, "value_2_out": {"scale_value": "get_var('trans', 2)", "range_in": [-12,12], "range_out": [1,13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 12, "value_2_out": {"scale_value": "get_var('trans', 3)", "range_in": [-12,12], "range_out": [1,13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 13, "value_2_out": {"scale_value": "get_var('trans', 4)", "range_in": [-12,12], "range_out": [1,13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 14, "value_2_out": {"scale_value": "get_var('trans', 5)", "range_in": [-12,12], "range_out": [1,13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 15, "value_2_out": {"scale_value": "get_var('trans', 6)", "range_in": [-12,12], "range_out": [1,13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 16, "value_2_out": {"scale_value": "get_var('trans', 7)", "range_in": [-12,12], "range_out": [1,13]}}
            ]
        },
        {
            "_comment": "CLOCK_IN Start",
            "device_in": "CLOCK_IN",
            "event_in": "start",
            "output": [
                {"var_0": 0}, {"var_1": 0}, {"var_2": 1}, {"var_3": -1},
                {"var_5": -1}, {"var_6": -1},
                {
                    "device_out": "XTMINI", "channel_out": 0, "event_out": "note_on",
                    "value_1_out": "var_0 + 8",
                    "value_2_out": 1
                }
            ]
        },
        {
            "_comment": "CLOCK_IN Stop",
            "device_in": "CLOCK_IN",
            "event_in": "stop",
            "output": [
                {"var_2": 0},
                {
                    "device_out": "OUTPUT",
                    "channel_out": "var_11 if var_5 != -1 and var_6 == var_11 else 15",
                    "event_out": "note_off",
                    "value_1_out": { "scale_notes": {"scale_value": "var_5", "scale_root": "var_4", "scale_type": "var_8"}},
                    "value_2_out": 0
                },
                {"var_5": -1}, {"var_6": -1},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 8, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 9, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 10, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 11, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 12, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 13, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 14, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": 15, "value_2_out": 0}
            ]
        },
        {
            "_comment": "CLOCK_IN Clock (Universal)",
            "device_in": "CLOCK_IN",
            "event_in": "clock",
            "output": [
                {
                    "_comment": "A. Note Off para nota anterior (var_5)",
                    "device_out": "OUTPUT",
                    "channel_out": "var_6 if var_2 == 1 and (var_1 + 1) % (6 * var_9) == 0 and var_5 != -1 and var_6 != -1 else 15",
                    "event_out": "note_off",
                    "value_1_out": { "scale_notes": {"scale_value": "var_5 + var_12", "scale_root": "var_4", "scale_type": "var_8"}},
                    "value_2_out": 0
                },
                {"var_5": "-1 if var_2 == 1 and (var_1 + 1) % (6 * var_9) == 0 and var_5 != -1 and var_6 != -1 else var_5"},
                {"var_6": "-1 if var_2 == 1 and (var_1 + 1) % (6 * var_9) == 0 and var_5 == -1 else var_6"},
                {
                    "_comment": "B.1 LED PASO ANTERIOR (var_3): Restaurar a su estado de MUTE",
                    "device_out": "XTMINI",
                    "channel_out": "0 if var_3 != -1 and var_2 == 1 and var_1 == 0 else 15",
                    "event_out": "note_on",
                    "value_1_out": "var_3",
                    "value_2_out": "get_var('mute', var_3)"
                },
                {
                    "_comment": "B.2 LED PASO ACTUAL (var_0): Invertir estado de MUTE para visualización de activo",
                    "device_out": "XTMINI",
                    "channel_out": "0 if var_2 == 1 and var_1 == 0 else 15",
                    "event_out": "note_on",
                    "value_1_out": "var_0",
                    "value_2_out": "toggle(get_var('mute', var_0))"
                },
                {"_comment": "B.3 Actualizar contadores (var_0 es el paso que acaba de empezar)"},
                {"var_3": "var_0 if var_2 == 1 and var_1 == 0 else var_3"},
                {"var_1": "(var_1 + 1) % (6 * var_9) if var_2 == 1 else var_1"}, 
                {"var_0": "(var_0 + var_15 + var_10) % var_10 if var_2 == 1 and var_1 == 0 else var_0"},

                {"_comment": "C. PREPARAR Note On para el paso ACTUAL (var_0)"},
                {"var_20": "var_4 + get_var('trans', var_0)"},
                {"var_21": "var_11 if var_2 == 1 and var_1 == 0 and get_var('mute', var_0) == 1 else 15"},
                {
                    "_comment": "D. Enviar Note On (escalado) si el paso está activo",
                    "device_out": "OUTPUT",
                    "channel_out": "var_21",
                    "event_out": "note_on",
                    "value_1_out": { "scale_notes": {"scale_value": "var_20 + var_12", "scale_root": "var_4", "scale_type": "var_8"}},
                    "value_2_out": "get_var('velo', var_0)"
                },
                {"_comment": "E. Actualizar var_5 con la nota RAW y var_6 con el canal, SI se envió Note On"},
                {"var_5": "var_20 if var_21 != 15 and var_1 == 0 else var_5"},
                {"var_6": "var_11 if var_21 != 15 and var_1 == 0 else var_6"}
            ]
        },
        {
            "_comment": "Toggle Mute para Pasos 0-15 (X-Touch Notas 0-15) - Aplica a todas las versiones",
            "device_in": "XTMINI",
            "event_in": "note",
            "ch_in": 0,
            "value_1_in": "0-15",
            "output": [
                {"set_var": [{"name": "mute", "index": "value_1_in", "value": "toggle(get_var('mute', value_1_in))"}]},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "note_on", "value_1_out": "value_1_in", "value_2_out": "get_var('mute', value_1_in)"}
            ]
        },
        {
            "_comment": "V1: Inicializar leds",
            "version": 1,
            "output": [
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 9,  "value_2_out": {"scale_value": "get_var('trans', 8)", "range_in": [-12,12], "range_out": [1, 13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 10, "value_2_out": {"scale_value": "get_var('trans', 9)", "range_in": [-12,12], "range_out": [1, 13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 11, "value_2_out": {"scale_value": "get_var('trans', 10)", "range_in": [-12,12], "range_out": [1, 13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 12, "value_2_out": {"scale_value": "get_var('trans', 11)", "range_in": [-12,12], "range_out": [1, 13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 13, "value_2_out": {"scale_value": "get_var('trans', 12)", "range_in": [-12,12], "range_out": [1, 13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 14, "value_2_out": {"scale_value": "get_var('trans', 13)", "range_in": [-12,12], "range_out": [1, 13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 15, "value_2_out": {"scale_value": "get_var('trans', 14)", "range_in": [-12,12], "range_out": [1, 13]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 16, "value_2_out": {"scale_value": "get_var('trans', 15)", "range_in": [-12,12], "range_out": [1, 13]}}
            ]
        },
        {
            "_comment": "V1: Transp. Pasos 0-15 (CCs de entrada 0-15). LEDs para Encoders 1-8 (CCs out 9-16)",
            "version": 1,
            "device_in": "XTMINI",
            "event_in": "cc",
            "ch_in": 0,
            "value_1_in": "0-15",
            "output": [
                {"set_var": [{"name": "trans", "index": "value_1_in", "value": "(value_2_in / 127) * 24 - 12"}]}
            ]
        },
        {
            "_comment": "V2: Refrescar LEDs Velocidad (Pasos 8-15) para Encoders 1-8 al entrar en V2",
            "version": 2, 
            "output": [
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 9,  "value_2_out": {"scale_value": "get_var('velo', 8)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 10, "value_2_out": {"scale_value": "get_var('velo', 9)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 11, "value_2_out": {"scale_value": "get_var('velo', 10)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 12, "value_2_out": {"scale_value": "get_var('velo', 11)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 13, "value_2_out": {"scale_value": "get_var('velo', 12)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 14, "value_2_out": {"scale_value": "get_var('velo', 13)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 15, "value_2_out": {"scale_value": "get_var('velo', 14)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 16, "value_2_out": {"scale_value": "get_var('velo', 15)", "range_in": [0,127], "range_out": [14,26]}}
            ]
        },
        {
            "_comment": "V2: Control Velocidad Pasos 0-7 (Encoders 1-8 -> CCs 0-7)",
            "version": 2,
            "device_in": "XTMINI",
            "event_in": "cc",
            "ch_in": 0,
            "value_1_in": "0-7",
            "output": [
                {"set_var": [{"name": "velo", "index": "value_1_in", "value": "value_2_in"}]},
                {
                    "device_out": "XTMINI", "channel_out": 0, "event_out": "cc",
                    "value_1_out": "value_1_in + 9",
                    "value_2_out": {"scale_value": "get_var('velo', value_1_in)", "range_in": [0,127], "range_out": [1, 13]}
                }
            ]
        },
        {
            "_comment": "V2: Control Velocidad Pasos 8-15 (Encoders 1-8 -> CCs 0-7)",
            "version": 2,
            "device_in": "XTMINI",
            "event_in": "cc",
            "ch_in": 0,
            "value_1_in": "8-15",
            "output": [
                {"set_var": [{"name": "velo", "index": "value_1_in", "value": "value_2_in"}]},
                {
                    "device_out": "XTMINI", "channel_out": 0, "event_out": "cc",
                    "value_1_out": "value_1_in + 1",
                    "value_2_out": {"scale_value": "get_var('velo', value_1_in)", "range_in": [0,127], "range_out": [14, 26]}
                }
            ]
        },
        {
            "_comment": "V3: Refrescar LEDs Velocidad (Pasos 8-15) para Encoders 1-8 al entrar en V2",
            "version": 3,
            "output": [
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 9,  "value_2_out": {"scale_value": "get_var('velo', 8)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 10, "value_2_out": {"scale_value": "get_var('velo', 9)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 11, "value_2_out": {"scale_value": "get_var('velo', 10)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 12, "value_2_out": {"scale_value": "get_var('velo', 11)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 13, "value_2_out": {"scale_value": "get_var('velo', 12)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 14, "value_2_out": {"scale_value": "get_var('velo', 13)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 15, "value_2_out": {"scale_value": "get_var('velo', 14)", "range_in": [0,127], "range_out": [14,26]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 16, "value_2_out": {"scale_value": "get_var('velo', 15)", "range_in": [0,127], "range_out": [14,26]}}
            ]
        },
        {
            "_comment": "V3: Control Velocidad Pasos 0-7 (Encoders 1-8 -> CCs 0-7)",
            "version": 3,
            "device_in": "XTMINI",
            "event_in": "cc",
            "ch_in": 0,
            "value_1_in": "0-7",
            "output": [
                {"set_var": [{"name": "velo", "index": "value_1_in", "value": "value_2_in"}]},
                {
                    "device_out": "XTMINI", "channel_out": 0, "event_out": "cc",
                    "value_1_out": "value_1_in + 9",
                    "value_2_out": {"scale_value": "get_var('velo', value_1_in)", "range_in": [0,127], "range_out": [1, 13]}
                }
            ]
        },
        {
            "_comment": "V3: Control Velocidad Pasos 8-15 (Encoders 1-8 -> CCs 0-7)",
            "version": 3,
            "device_in": "XTMINI",
            "event_in": "cc",
            "ch_in": 0,
            "value_1_in": "8-15",
            "output": [
                {"set_var": [{"name": "velo", "index": "value_1_in", "value": "value_2_in"}]},
                {
                    "device_out": "XTMINI", "channel_out": 0, "event_out": "cc",
                    "value_1_out": "value_1_in + 1",
                    "value_2_out": {"scale_value": "get_var('velo', value_1_in)", "range_in": [0,127], "range_out": [1, 13]}
                }
            ]
        },
        {
            "_comment": "V4: Inicializar LEDs para Controles Globales/Secuencia",
            "version": 4,
            "output": [
                {"_comment": "Encoder 1 (CC9 LED): var_9 (Step Duration Multiplier 1-6)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 9, "value_2_out": 1},
                {"_comment": "Encoder 2 (CC10 LED): var_10 (Num Steps 1-16)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 10, "value_2_out": 13},
                {"_comment": "Encoder 3 (CC11 LED): var_11 (Output Channel 0-15)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 11, "value_2_out": 1},
                {"_comment": "Encoders 4-7 (CC12-CC15 LEDs): Apagados o valor neutral"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 12, "value_2_out": 0},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 13, "value_2_out": 27},

                {"_comment": "Encoder 6 (CC14 LED): var_15 (Step Interval/Direction -6 a +6)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 14, "value_2_out": 8},

                {"_comment": "Encoder 7 (CC15 LED): var_8 (Scale Type) - Mapeo de nombre a índice para LED"},
                {"var_22": "0 if var_8 == 'virus_minor' else (1 if var_8 == 'simple_triad' else (2 if var_8 == 'major' else (3 if var_8 == 'minor_natural' else (4 if var_8 == 'minor_harmonic' else (5 if var_8 == 'pentatonic_major' else (6 if var_8 == 'pentatonic_minor' else (7 if var_8 == 'chromatic' else (8 if var_8 == 'blues' else 1))))))))"},

                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 15, "value_2_out": 1},
                {"_comment": "Encoder 8 (CC16 LED): var_12 (Global Transpose -24 a +24)"},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 16, "value_2_out": 7}
            ]
        },

        
        {
            "_comment": "V4: CC0/CC8 (Enc 1) -> var_9 (Step Duration Multiplier 1-6)",
            "version": 4, "device_in": "XTMINI", "event_in": "cc", "ch_in": 0, "value_1_in": [0, 8],
            "output": [
                {"var_9": {"scale_value": "value_2_in", "range_in": [0,127], "range_out": [1,8]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 9, "value_2_out": {"scale_value": "var_9", "range_in": [1,8], "range_out": [1,13]}}
            ]
        },
        {
            "_comment": "V4: CC1/CC9 (Enc 2) -> var_10 (Num Steps 1-16)",
            "version": 4, "device_in": "XTMINI", "event_in": "cc", "ch_in": 0, "value_1_in": [1, 9],
            "output": [
                {"var_10": {"scale_value": "value_2_in", "range_in": [0,127], "range_out": [1,16]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 10, "value_2_out": {"scale_value": "var_10", "range_in": [1,16], "range_out": [1,13]}}
            ]
        },
        {
            "_comment": "V4: CC2/CC10 (Enc 3) -> var_11 (Output Channel 0-15)",
            "version": 4, "device_in": "XTMINI", "event_in": "cc", "ch_in": 0, "value_1_in": [2, 10],
            "output": [
                {"var_11": {"scale_value": "value_2_in", "range_in": [0,127], "range_out": [0,15]}},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 11, "value_2_out": {"scale_value": "var_11", "range_in": [0,15], "range_out": [1,13]}}
            ]
        },
        {
            "_comment": "V4: CC5/CC13 (Enc 6) -> var_15 (Step Interval/Direction -6 a +6)",
            "version": 4,
            "device_in": "XTMINI",
            "event_in": "cc",
            "ch_in": 0,
            "value_1_in": [5, 13],
            "output": [
                {"var_15": {"scale_value": "value_2_in", "range_in": [0,127], "range_out": [-6,6]}},
                {
                    "device_out": "XTMINI",
                    "channel_out": 0,
                    "event_out": "cc",
                    "value_1_out": 14, 
                    "value_2_out": {"scale_value": "var_15", "range_in": [-6,6], "range_out": [1,13]}
                }
            ]
        },
        {
            "_comment": "V4: CC6/CC14 (Enc 7) -> var_8 (Scale Type)",
            "version": 4,
            "device_in": "XTMINI",
            "event_in": "cc",
            "ch_in": 0,
            "value_1_in": [6, 14],
            "output": [
                {"var_22": {"scale_value": "value_2_in", "range_in": [0,127], "range_out": [0,8]}},
                {"var_8": "'virus_minor' if var_22 == 0 else ('simple_triad' if var_22 == 1 else ('major' if var_22 == 2 else ('minor_natural' if var_22 == 3 else ('minor_harmonic' if var_22 == 4 else ('pentatonic_major' if var_22 == 5 else ('pentatonic_minor' if var_22 == 6 else ('chromatic' if var_22 == 7 else 'blues')))))))"},
                {
                    "device_out": "XTMINI",
                    "channel_out": 0,
                    "event_out": "cc",
                    "value_1_out": 15,
                    "value_2_out": {"scale_value": "var_22", "range_in": [0,6], "range_out": [1,13]}
                }
            ]
        },
        {
            "_comment": "V4: CC7/CC15 (Enc 8) -> var_12 (Global Transpose -24 a +24)",
            "version": 4, "device_in": "XTMINI", "event_in": "cc", "ch_in": 0, "value_1_in": [7, 15],
            "output": [
                {"var_12": {"scale_value": "value_2_in", "range_in": [0,127], "range_out": [-24,24], "_comment_scale_type": "bipolar_center_64_is_0" }},
                {"device_out": "XTMINI", "channel_out": 0, "event_out": "cc", "value_1_out": 16, "value_2_out": {"scale_value": "var_12", "range_in": [-24,24], "range_out": [1,13]}}
            ]
        },


        {
            "_comment": "X-Touch CC127 - Aplica a todas las versiones",
            "device_in": "XTMINI", "event_in": "cc", "value_1_in": 127,
            "output": [{"device_out": "TPT_OUT"}]
        },
        {
            "_comment": "Nota 38,46",
            "device_in": "XTMINI", "event_in": "note_on", "ch_in": 0, "value_1_in": [38, 46], "value_2_in": ">0",
            "output": [ {"var_4": "var_4 - 1"} ]
        },
        {
            "_comment": "Nota 39,47",
            "device_in": "XTMINI", "event_in": "note_on", "ch_in": 0, "value_1_in": [39, 47], "value_2_in": ">0",
            "output": [ {"var_4": "var_4 + 1"} ]
        },
        {
            "_comment": "Nota 41,49 STOP", "device_in": "XTMINI", "event_in": "note_on", "value_1_in": [41, 49], "value_2_in": ">0", "output": [ {"device_out": "TPT_OUT", "event_out":"stop"} ]
        },
        {
            "_comment": "Nota 42,50 PLAY", "device_in": "XTMINI", "event_in": "note_on", "value_1_in": [42, 50], "value_2_in": ">0", "output": [ {"device_out": "TPT_OUT", "event_out":"start"} ]
        }
    ]
}